<!DOCTYPE html>
<html>
<head>
    <title><%= title %></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
</head>
<body>
<%- include('./partials/navbar'); %>
<div class="container">
    <h1><%= title %></h1>
        <fieldset>
            <div class="control-group">
                <!-- E-mail -->
                <label class="control-label" for="email">E-mail</label>
                <div class="controls">
                    <input type="text" id="email" name="email" placeholder="" class="input-xlarge">
                    <p class="help-block">Please provide your E-mail</p>
                </div>
            </div>

            <div class="control-group">
                <!-- Password-->
                <label class="control-label" for="password">Password</label>
                <div class="controls">
                    <input type="password" id="password" name="password" placeholder="" class="input-xlarge">
                    <p class="help-block">Password should be at least 4 characters</p>
                </div>
            </div>

            <div class="control-group">
                <!-- Button -->
                <div class="controls">
                    <button class="btn btn-success" onclick="loginOnClick()">Login</button>
                </div>
            </div>
        </fieldset>

    <script>
        function loginOnClick(key, value) {
            let email = document.getElementById('email').value;
            let password = document.getElementById('password').value;
            let data = JSON.stringify({
                "email": email,
                "password": password
            });
            let xhr = new XMLHttpRequest();
            xhr.withCredentials = true;

            xhr.open("POST", '/api/auth/login', true);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.onload  = function() {
                let json = JSON.parse(xhr.response);
                if (json.token) {
                    document.cookie = `jwt=${json.token}; Path=/;`
                }
            };
            xhr.send(data);
        }
    </script>
</div>
</body>
</html>
